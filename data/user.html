<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="Cache-Control" content="no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>User Dashboard</title>
  <link rel="stylesheet" href="css/user.css?v=2" />
  <style>
    .user-status-global {
      position: absolute;
      top: 10px;
      right: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
      z-index: 1000;
    }

    .user-icon {
      cursor: pointer;
    }

    .user-menu {
      position: absolute;
      top: 35px;
      right: 0;
      display: none;
      background: rgba(0, 0, 0, 0.7);
      border-radius: 8px;
      padding: 10px;
      box-shadow: 0 0 8px rgba(0, 0, 0, 0.4);
    }

    .user-menu button {
      background: none;
      border: none;
      color: white;
      cursor: pointer;
      display: block;
      margin: 5px 0;
    }
  </style>
</head>
<body>
  <div class="ui-container">

    <!-- User icon and dropdown always on top-right -->
    <div class="user-status-global">
      <div class="status-dot" title="Auto Mode"></div>
      <div class="user-icon" onclick="toggleUserMenu()">ðŸ‘¤</div>
      <div class="user-menu" id="userMenu">
        <button id="editCredentialsBtn" type="button">Edit Credentials</button>
        <button id="disconnectBtn" type="button">Disconnect</button>
      </div>
    </div>

    <!-- Sidebar -->
    <div class="sidebar">
      <div class="tab active" onclick="switchTab(0)">Auto Mode</div>
      <div class="tab" onclick="switchTab(1)">Manual Mode</div>

      <div class="sidebar-controls" style="margin-top: 30px; display: flex; flex-direction: column; align-items: center; gap: 12px;">
        <div class="round-button start" onclick="startSystem()" title="Start System">
          <img src="icons/ok_tank.png" alt="Start">
        </div>
        <div class="round-button stop" onclick="shutdownSystem()" title="Shutdown System">
          <img src="icons/power.png" alt="Shutdown">
        </div>
      </div>
    </div>

    <!-- Auto Mode Content -->
    <div class="content active" id="autoTab">
      <div class="content-header">
        <h2>Dashboard</h2>
      </div>

      <div class="mode-toggle" style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
        <label>Auto</label>
        <label class="switch">
          <input type="checkbox" id="modeToggle" onchange="toggleMode()">
          <span class="slider"></span>
        </label>
        <label>Manual</label>

        <label style="margin-left: 20px;">LT</label>
        <label class="switch">
          <input type="checkbox" id="ltToggle" onchange="toggleLT()">
          <span class="slider"></span>
        </label>

        <span style="margin-left: 30px;">Ready</span>
        <div id="readyLed" style="width: 12px; height: 12px; background-color: gray; border-radius: 50%;"></div>
        <span style="margin-left: 20px;">OFF</span>
        <div id="offLed" style="width: 12px; height: 12px; background-color: gray; border-radius: 50%;"></div>
      </div>

      <div class="gauges">
        <!-- Voltage -->
        <div class="gauge-card">
          <div class="gauge">
            <svg viewBox="0 0 36 36" class="gauge-svg">
              <g transform="rotate(-90 18 18)">
                <path class="gauge-bg" d="M18 2.0845 a15.9155 15.9155 0 1 1 0 31.831 a15.9155 15.9155 0 1 1 0 -31.831"/>
                <path class="gauge-fg voltage" stroke-dasharray="92, 100"
                      d="M18 2.0845 a15.9155 15.9155 0 1 1 0 31.831 a15.9155 15.9155 0 1 1 0 -31.831"/>
              </g>
              <text x="18" y="18" class="gauge-value" transform="rotate(90 18 18)" id="voltageValue">230V</text>
            </svg>
          </div>
          <div class="gauge-label">Voltage</div>
        </div>

        <!-- Current -->
        <div class="gauge-card">
          <div class="gauge">
            <svg viewBox="0 0 36 36" class="gauge-svg">
              <g transform="rotate(-90 18 18)">
                <path class="gauge-bg" d="M18 2.0845 a15.9155 15.9155 0 1 1 0 31.831 a15.9155 15.9155 0 1 1 0 -31.831"/>
                <path class="gauge-fg current" stroke-dasharray="60, 100"
                      d="M18 2.0845 a15.9155 15.9155 0 1 1 0 31.831 a15.9155 15.9155 0 1 1 0 -31.831"/>
              </g>
              <text x="18" y="18" class="gauge-value" transform="rotate(90 18 18)" id="currentValue">1.2A</text>
            </svg>
          </div>
          <div class="gauge-label">Current</div>
        </div>

        <!-- Temperature Gauges -->
        <!-- Temp 1 -->
        <div class="gauge-card">
          <div class="gauge">
            <svg viewBox="0 0 36 36" class="gauge-svg">
              <g transform="rotate(-90 18 18)">
                <path class="gauge-bg" d="M18 2.0845 a15.9155 15.9155 0 1 1 0 31.831 a15.9155 15.9155 0 1 1 0 -31.831"/>
                <path class="gauge-fg temperature" stroke-dasharray="70, 100"
                      d="M18 2.0845 a15.9155 15.9155 0 1 1 0 31.831 a15.9155 15.9155 0 1 1 0 -31.831"/>
              </g>
              <text x="18" y="18" class="gauge-value" transform="rotate(90 18 18)" id="temp1Value">35Â°C</text>
            </svg>
          </div>
          <div class="gauge-label">Temp 1</div>
        </div>

        <!-- Temp 2 -->
        <div class="gauge-card">
          <div class="gauge">
            <svg viewBox="0 0 36 36" class="gauge-svg">
              <g transform="rotate(-90 18 18)">
                <path class="gauge-bg" d="M18 2.0845 a15.9155 15.9155 0 1 1 0 31.831 a15.9155 15.9155 0 1 1 0 -31.831"/>
                <path class="gauge-fg temperature" stroke-dasharray="68, 100"
                      d="M18 2.0845 a15.9155 15.9155 0 1 1 0 31.831 a15.9155 15.9155 0 1 1 0 -31.831"/>
              </g>
              <text x="18" y="18" class="gauge-value" transform="rotate(90 18 18)" id="temp2Value">34Â°C</text>
            </svg>
          </div>
          <div class="gauge-label">Temp 2</div>
        </div>

        <!-- Temp 3 -->
        <div class="gauge-card">
          <div class="gauge">
            <svg viewBox="0 0 36 36" class="gauge-svg">
              <g transform="rotate(-90 18 18)">
                <path class="gauge-bg" d="M18 2.0845 a15.9155 15.9155 0 1 1 0 31.831 a15.9155 15.9155 0 1 1 0 -31.831"/>
                <path class="gauge-fg temperature" stroke-dasharray="72, 100"
                      d="M18 2.0845 a15.9155 15.9155 0 1 1 0 31.831 a15.9155 15.9155 0 1 1 0 -31.831"/>
              </g>
              <text x="18" y="18" class="gauge-value" transform="rotate(90 18 18)" id="temp3Value">36Â°C</text>
            </svg>
          </div>
          <div class="gauge-label">Temp 3</div>
        </div>

        <!-- Temp 4 -->
        <div class="gauge-card">
          <div class="gauge">
            <svg viewBox="0 0 36 36" class="gauge-svg">
              <g transform="rotate(-90 18 18)">
                <path class="gauge-bg" d="M18 2.0845 a15.9155 15.9155 0 1 1 0 31.831 a15.9155 15.9155 0 1 1 0 -31.831"/>
                <path class="gauge-fg temperature" stroke-dasharray="74, 100"
                      d="M18 2.0845 a15.9155 15.9155 0 1 1 0 31.831 a15.9155 15.9155 0 1 1 0 -31.831"/>
              </g>
              <text x="18" y="18" class="gauge-value" transform="rotate(90 18 18)" id="temp4Value">37Â°C</text>
            </svg>
          </div>
          <div class="gauge-label">Temp 4</div>
        </div>
      </div>
    </div>

    <!-- Manual Mode Content -->
    <div class="content" id="manualTab">
      <div class="content-header">
        <h2>Manual Control</h2>
      </div>
      <div class="manual-outputs" id="manualOutputs"></div>
    </div>
  </div>

  <!-- Modal -->
  <div class="user-modal" id="userModal">
    <div class="user-modal-content">
      <h3>Update Credentials</h3>
      <input type="password" id="currentPassword" placeholder="Current Password" />
      <input type="password" id="newPassword" placeholder="New Password" />
      <input type="text" id="newId" placeholder="New Device ID" />
      <div class="user-modal-actions round-actions">
        <div class="round-button save" onclick="saveUserSettings()">
          <img src="icons/ok_tank.png" alt="Save">
        </div>
        <div class="round-button cancel" onclick="closeUserModal()">
          <img src="icons/close.png" alt="Cancel">
        </div>
      </div>
    </div>
  </div>

  <div class="footer">
    &copy; 2025 Power Distribution Interface
  </div>

  <script src="js/user.js?v=2"></script>
</body>
</html>
