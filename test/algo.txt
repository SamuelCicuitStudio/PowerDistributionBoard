Hardware‐Resistor Start Routine

[ESP Power-Up on 3.3 V rail]
    ↓
[Initialize GPIOs, PWM, OneWire + Read NVS prefs]
    ↓
[CALIBRATE ADC → calibMax over 50 ms window]
    ↓
[“Hardware-Resistor” Mode Active]
    ↓
┌─────────────────────────────────────────────┐
│ WHILE ((raw = analogRead())/calibMax*100)   │
│       < CHARGE_THRESHOLD_PERCENT            │
│   delay(100 ms)                             │
└─────────────────────────────────────────────┘
    ↓
[READY_LED_PIN = HIGH]
    ↓
[Wait for POWER_ON_SWITCH_PIN rising edge]
    ↓
systemOn = true
    ↓
┌───────────────────────────────────────────────────────────┐
│                  RTOS–DRIVEN TASKS                        │
│ • Heating Seq. (onTime/offTime loop per channel)          │
│ • Temp Safety (every 500 ms → shut off if > threshold)    │
│ • 12 V Loss Safety (every 200 ms → shut off if lost)      │
│ • Voltage Monitor (every 100 ms → update measuredVoltage) │
└───────────────────────────────────────────────────────────┘

Software-Inrush Start Routine
[ESP Power-Up on 3.3 V rail]
    ↓
[Initialize GPIOs, PWM, OneWire + Read NVS prefs]
    ↓
[CALIBRATE ADC → calibMax over 50 ms window]
    ↓
[“Software-Inrush” Mode Active]
    ↓
┌───────────────────────────────────────────────────┐
│ FOR duty = 0 → PWM_DUTY_CYCLE step Δ              │
│   ledcWrite(PWM_CHANNEL, duty)                    │
│   delay(100 ms)                                   │
│   raw = analogRead()                              │
│   pct = raw/calibMax*100                          │
│   IF pct < (duty/PWM_DUTY_CYCLE)*THRESHOLD        │
│     delay(100 ms)  // wait for voltage catch-up   │
└───────────────────────────────────────────────────┘
    ↓
[ledcWrite(PWM_CHANNEL, PWM_DUTY_CYCLE)]
    ↓
[READY_LED_PIN = HIGH]
    ↓
[Wait for POWER_ON_SWITCH_PIN rising edge]
    ↓
systemOn = true
    ↓
┌──────────────────────────────────────────────────────────┐
│                  RTOS–DRIVEN TASKS                       │
│ • Heating Seq. (onTime/offTime loop per channel)         │
│ • Temp Safety (every 500 ms → shut off if > threshold)   │
│ • 12 V Loss Safety (every 200 ms → shut off if lost)     │
│ • Voltage Monitor (every 100 ms → update measuredVoltage)│
└──────────────────────────────────────────────────────────┘
